clear all
clc
addpath('../../../tools/matlab_bin/')

%satellite
[Nsat_GLOBAL,ERRsat_GLOBAL,Nsat_REGIONAL,ERRsat_REGIONAL] = satellite_error('../obs/satellite_obs.nc',...
'lon','lat','time','swh','../WORKDIR/ww3_ounf_OUTGRID/ww3_out_grd_OUTGRID.nc','longitude',...
'latitude','time','hs',LONMIN,LONMAX,LATMIN,LATMAX);
%buoy
[Nbuoy_GLOBAL,ERRbuoy_GLOBAL,Nbuoy_REGIONAL,ERRbuoy_REGIONAL] = buoy_error('../obs/BUOY.nc',...
'station_name','time','wave_height','../WORKDIR/ww3_out_pnt_tab.nc','station_name','time','hs',...
LONMIN,LONMAX,LATMIN,LATMAX);
%global
ErrTot_GLOBAL=((Nsat_GLOBAL*ERRsat_GLOBAL)+(Nbuoy_GLOBAL*ERRbuoy_GLOBAL))/(Nsat_GLOBAL+Nbuoy_GLOBAL)
fileID = fopen('../INPUTDIR/Err_GLOBAL','w');
fprintf(fileID,'%f\n',ErrTot_GLOBAL);
fclose(fileID);
fileID = fopen('../WORKDIR/Err_GLOBAL','w');
fprintf(fileID,'%f\n',ErrTot_GLOBAL);
fclose(fileID);
%regional
ErrTot_REGIONAL=((Nsat_REGIONAL*ERRsat_REGIONAL)+(Nbuoy_REGIONAL*ERRbuoy_REGIONAL))/(Nsat_REGIONAL+Nbuoy_REGIONAL)
fileID = fopen('../INPUTDIR/Err_REGIONAL','w');
fprintf(fileID,'%f\n',ErrTot_REGIONAL);
fclose(fileID);
fileID = fopen('../WORKDIR/Err_REGIONAL','w');
fprintf(fileID,'%f\n',ErrTot_REGIONAL);
fclose(fileID);

% Normalize input variables
input_nml=importdata('../INPUTDIR/inp.nml');
input_upper_bound_nml=importdata('../INPUTDIR/inp_upper_bound.nml');
input_lower_bound_nml=importdata('../INPUTDIR/inp_lower_bound.nml');

for i=1:length(input_nml)
   [input_norm_nml(1,i)] = normalize(input_lower_bound_nml(i),input_upper_bound_nml(i),VMIN,VMAX,input_nml(i));
end

dlmwrite('inp_norm.nml',input_norm_nml,'Delimiter',' ','precision',6)




